<script type="module">
    import mermaid from "https://cdn.skypack.dev/mermaid@8.14.0";

    document.querySelectorAll("pre.mermaid, pre>code.language-mermaid").forEach($el => {
    // if the second selector got a hit, reference the parent <pre>
    if ($el.tagName === "CODE")
        $el = $el.parentElement
    // put the Mermaid contents in the expected <div class="mermaid">
    // plus keep the original contents in a nice <details>
    $el.outerHTML = `
        <div class="mermaid">${$el.textContent}</div>
        <details>
        <summary>Diagram source</summary>
        <pre>${$el.textContent}</pre>
        </details>
    `
    })


    mermaid.initialize({
    logLevel: "error", // [1]
    securityLevel: "loose", // [2]
    theme: (window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) ?
        "dark" :
        "default" // [3]
    })
</script>

<script async src="/Assets/js/twitter_widgets.js" charset="utf-8"></script>
